# Feature engineering for molecular SMILES 

**Author:** senkin.zhan@datarobot.com

[Download example data here](https://s3.us-east-1.amazonaws.com/datarobot_public_datasets/ai_accelerators/smiles.csv)

## Problem framing

SMILES (Simplified molecular input line entry system) is a textual representation of molecular structures. While it's compact and widely used in cheminformatics, SMILES strings must be transformed into numerical representations to be used effectively in machine learning models.

## Accelerator overview

This guide introduces a feature engineering pipeline tailored for SMILES-formatted molecular data. It demonstrates how to convert raw SMILES strings into machine-learning-ready features using RDKit and other tools. It is recommended to run this notebook in a DataRobot codespace using a GPU environment.

This accelerator's workflow is summarized below.

1. Preprocess and visualize SMILES strings using RDKit and py3Dmol.
2. Extract molecular descriptors statistical features (physicochemical properties).
3. Extract TF-IDF features from SMILES strings, then apply TruncatedSVD to obtain lower-dimensional embeddings.
4. Extract fingerprints features from SMILES strings, then apply TruncatedSVD to obtain lower-dimensional embeddings.
5. Extract semantic representations from pretrained molecular embeddings of ChemBERTa and SMILESBERT (CPU is slow. GPU is recommended.), then apply PCA to obtain lower-dimensional embeddings.
6. Run DataRobot Autopilot with these features to compare model performance and create benchmarks.
7. Extract feature contribution(shap values)
   
Present the performance benchmarks generated by DataRobot

|Feature set           |hyper-parameters          |LogLoss                   |ROC AUC                   |
|----------------------|--------------------------|--------------------------|--------------------------|
| Descriptors||0.2756|0.7833|
| Fingerprints+SVD|radius:2|0.3097|0.7250|
| Fingerprints+SVD|radius:3|0.3072|0.7315|
| Fingerprints+SVD|radius:4|0.3069|0.7326|
|TF-IDF|n_gram:1~3,min_df=5|0.2874|0.7738|
|TF-IDF|n_gram:1~8,min_df=100|0.2822|0.7787|
|TF-IDF+SVD|n_gram:1~3,min_df=5,svd dim:10|0.3053|0.7421|
|TF-IDF+SVD|n_gram:1~8,min_df=100,svd dim:10|0.3042|0.7465|
|Chemberta+PCA|pca dim:10|0.3107|0.7389|
|SMILES BERT+PCA|pca dim:10|0.3127|0.7368|
|Descriptors+Fingerprints|radius:3|0.2749|0.7835|
|Descriptors+Fingerprints+TF-IDF|radius:3,n_gram:1~8,min_df=100|0.2742|0.7866|
|Descriptors+Fingerprints+TF-IDF+Chemberta|radius:3,n_gram:1~8,min_df=100|0.2738|0.7878|
